namespace = annexation_referendum

### PLACEHOLDERS ###
# Advancement event
#Rousing Speech held - IG leader in favour of current law turns out to be quite the orator. Speech widely distributed, swaying people towards supporting the law
annexation_referendum.1 = {
	type = country_event
	placement = root
	title = annexation_referendum.1.t
	desc = annexation_referendum.1.d
	flavor = annexation_referendum.1.f
	event_image = {
		video = "gfx/event_pictures/unspecific_ruler_speaking_to_people.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/unspecific/leader_speaking_to_a_group_of_people"
	icon = "gfx/interface/icons/event_icons/event_protest.dds"
	duration = 3
	cooldown = {
		months = 6
	}
	trigger = {
		has_journal_entry = annexation_referendum_je
		any_interest_group = {
			is_marginal = no
			leader = {
				culture = {
					is_primary_culture_of = root.overlord
				}
			}
		}
	}
	immediate = {
		random_interest_group = {
			limit = {
				is_marginal = no
				leader = {
					culture = {
						is_primary_culture_of = root.overlord
					}
				}
			}
			save_scope_as = orator_ig_scope
			leader = {
				save_scope_as = orator_ig_leader_scope
			}
		}
	}
	cancellation_trigger = {
		NOT = {
			has_journal_entry = annexation_referendum_je
		}
	}
	option = {
		name = annexation_referendum.1.a		# Focus attention on passing the law
		default_option = yes
		custom_tooltip = {
			text = annexation_referendum.1.a.tt
		}
		change_variable = {
			name = weekly_annexation_support
			add = 0.5
		}
	}
	option = {
		name = annexation_referendum.1.b		# Divert attention to IG and IG leader
		custom_tooltip = {
			text = annexation_referendum.1.b.tt
		}
		change_variable = {
			name = weekly_annexation_support
			add = 0.5
		}
		scope:orator_ig_leader_scope = {
			add_modifier = {
				name = skilled_orator
				months = 6
			}
		}
		scope:orator_ig_scope = {
			add_modifier = {
				name = rising_support_for_ig_minor
				months = 6
			}
		}
	}
}

# Stall event
# Corrupt Connections uncovered - IG in favour of passing law cought in corruption scandal. 
annexation_referendum.2 = {
	type = country_event
	placement = root
	title = annexation_referendum.2.t
	desc = annexation_referendum.2.d
	flavor = annexation_referendum.2.f
	event_image = {
		video = "gfx/event_pictures/europenorthamerica_capitalists_meeting.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/europenorthamerica/capitalists_meeting"
	icon = "gfx/interface/icons/event_icons/event_scales.dds"
	duration = 3
	cooldown = {
		months = 6
	}
	trigger = {
		has_journal_entry = annexation_referendum_je
		any_interest_group = {
			is_marginal = no
			is_in_government = yes
		}
	}
	immediate = {
		random_interest_group = {
			limit = {
				is_marginal = no
				is_in_government = yes
			}
			save_scope_as = corrupt_ig_scope
			leader = {
				save_scope_as = corrupt_ig_leader_scope
			}
		}
	}
	cancellation_trigger = {
		NOT = {
			has_journal_entry = annexation_referendum_je
		}
	}
	option = {
		name = annexation_referendum.2.a		# nothing is done about the corruption. bad for law passing and bad PR for IG and IG leader
		default_option = yes
		custom_tooltip = {
			text = annexation_referendum.2.a.tt
		}
		change_variable = {
			name = weekly_annexation_support
			add = -0.5
		}
		scope:corrupt_ig_leader_scope = {
			add_modifier = {
				name = ignored_corruption
				months = 6
			}
		}
	}
	option = {
		name = annexation_referendum.2.b		# negative effects mitigated somewhat, but at a cost to bureaucracy
		custom_tooltip = {
			text = annexation_referendum.2.b.tt
		}
		change_variable = {
			name = weekly_annexation_support
			add = -0.25
		}
		add_modifier = {
			name = dealing_with_corruption
			months = 6
		}
	}
}


# Advancement Event
# Celebrity Endorses Annexation
annexation_referendum.4 = {
	type = country_event
	placement = scope:playwright_state_scope
	title = annexation_referendum.4.t
	desc = annexation_referendum.4.d
	flavor = annexation_referendum.4.f
	event_image = {
		video = "gfx/event_pictures/middleeast_middleclass_cafe.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/middleclass_cafe"
	icon = "gfx/interface/icons/event_icons/event_newspaper.dds"
	duration = 3
	cooldown = {
		months = 6
	}
	trigger = {
		has_journal_entry = annexation_referendum_je
		any_interest_group = {
			is_marginal = no
			law_stance = {
				law = owner.currently_enacting_law.type
				value > neutral
			}
		}
		any_scope_state = {
			is_incorporated = yes
		}
		NOT = {
			has_variable = playwright_var
		}
	}
	immediate = {
		random_scope_state = {
			limit = {
				is_incorporated = yes
			}
			save_scope_as = playwright_state_scope
		}
		random_interest_group = {
			limit = {
				is_marginal = no
				law_stance = {
					law = owner.currently_enacting_law.type
					value > neutral
				}
			}
			save_scope_as = playwright_ig_scope
		}
		set_variable = {
			name = playwright_var
			months = 6
		}
	}
	cancellation_trigger = {
		NOT = {
			has_journal_entry = annexation_referendum_je
		}
	}
	option = {
		name = annexation_referendum.4.a		# Play convinces/puts pressure, making passing law easier
		default_option = yes
		change_variable = {
			name = weekly_annexation_support
			add = 0.25
		}
	}
	option = {
		name = annexation_referendum.4.b		# Play strenghens IG that playwright alligns with
		scope:playwright_ig_scope = {
			add_modifier = {
				name = rising_support_for_ig
				months = 6
			}
		}
	}
}

# Stall Event
# Bureaucratic Imbroglio
annexation_referendum.5 = {
	type = country_event
	placement = root
	title = annexation_referendum.5.t
	desc = annexation_referendum.5.d
	flavor = annexation_referendum.5.f
	event_image = {
		video = "gfx/event_pictures/africa_leader_arguing.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/africa/leader_arguing"
	icon = "gfx/interface/icons/event_icons/event_scales.dds"
	duration = 3
	cooldown = {
		months = 6
	}
	trigger = {
		has_journal_entry = annexation_referendum_je
	}
	immediate = {
		random_scope_state = {
			limit = {
				is_capital = yes
			}
			save_scope_as = imbroglio_state_scope
		}
	}
	cancellation_trigger = {
		NOT = {
			has_journal_entry = annexation_referendum_je
		}
	}
	option = {
		name = annexation_referendum.5.a		# That's bad, but not much to do about it.
		default_option = yes
		custom_tooltip = {
			text = annexation_referendum.5.a.tt
		}
		change_variable = {
			name = weekly_annexation_support
			add = -0.5
		}
	}
	option = {
		name = annexation_referendum.5.b		# Cut through some red tape, decreasing maluses, but angering bureaucrats
		custom_tooltip = {
			text = annexation_referendum.5.b.tt
		}
		change_variable = {
			name = weekly_annexation_support
			add = -0.25
		}
		add_modifier = {
			name = cutting_red_tape
			months = 6
		}
		scope:imbroglio_state_scope = {
			add_radicals = {
				# bureaucracts pissed off
				value = large_radicals
				pop_type = bureaucrats
			}
		}
	}
}

# Debate event
#King/Queen/Emperor intervenes in political process
annexation_referendum.6 = {
	type = country_event
	placement = root
	title = annexation_referendum.6.t
	desc = annexation_referendum.6.d
	flavor = annexation_referendum.6.f
	event_image = {
		video = "gfx/event_pictures/unspecific_ruler_speaking_to_people.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/unspecific/leader_speaking_to_a_group_of_people"
	icon = "gfx/interface/icons/event_icons/event_protest.dds"
	duration = 3
	cooldown = {
		months = 6
	}
	trigger = {
		has_law = law_type:law_monarchy
		enacting_any_law = yes
		any_interest_group = {
			is_marginal = no
			OR = {
				has_ideology = ideology_republican
				law_stance = {
					law = law_type:law_monarchy
					value < neutral
				}
			}
		}
	}
	immediate = {
	}
	cancellation_trigger = {
		NOT = {
			has_journal_entry = annexation_referendum_je
		}
	}
	option = {
		name = annexation_referendum.6.a		# Let the King have his way
		custom_tooltip = {
			text = annexation_referendum.6.a.tt
		}
		change_variable = {
			name = weekly_annexation_support
			add = 0.25
		}
		every_interest_group = {
			limit = {
				is_marginal = no
				OR = {
					has_ideology = ideology_republican
					law_stance = {
						law = law_type:law_monarchy
						value < neutral
					}
				}
			}
			add_modifier = {
				name = royal_prerogative
				months = 6
			}
		}
	}
	option = {
		name = annexation_referendum.6.b		# Preserve the bill
		default_option = yes
		custom_tooltip = {
			text = annexation_referendum.6.b.tt
		}
	}
}

# Advancement Event
# Grassroots Support for Law
annexation_referendum.7 = {
	type = country_event
	placement = scope:grassroots_state_scope
	title = annexation_referendum.7.t
	desc = annexation_referendum.7.d
	flavor = annexation_referendum.7.f
	event_image = {
		video = "gfx/event_pictures/middleeast_middleclass_cafe.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/middleclass_cafe"
	icon = "gfx/interface/icons/event_icons/event_protest.dds"
	duration = 3
	cooldown = {
		months = 6
	}
	trigger = {
		has_journal_entry = annexation_referendum_je
		any_interest_group = {
			is_marginal = no
			leader = {
				culture = {
					is_primary_culture_of = root.overlord
				}
			}
		}
		any_scope_state = {
			is_incorporated = yes
			any_scope_pop = {
				culture = {
					is_primary_culture_of = root.overlord
				}
			}
		}
	}
	immediate = {
		random_interest_group = {
			limit = {
				is_marginal = no
				leader = {
					culture = {
						is_primary_culture_of = root.overlord
					}
				}
			}
			save_scope_as = grassroots_ig_scope
		}
		random_scope_state = {
			limit = {
				is_incorporated = yes
				any_scope_pop = {
					culture = {
						is_primary_culture_of = root.overlord
					}
				}
			}
			save_scope_as = grassroots_state_scope
		}
	}
	cancellation_trigger = {
		NOT = {
			has_journal_entry = annexation_referendum_je
		}
	}
	option = {
		name = annexation_referendum.7.a		# popular support for law and pro-law IG
		default_option = yes
		custom_tooltip = {
			text = annexation_referendum.7.a.tt
		}
		change_variable = {
			name = weekly_annexation_support
			add = 0.5
		}
		scope:grassroots_ig_scope = {
			add_modifier = {
				name = grassroots_support
				months = 6
			}
		}
	}
	option = {
		name = annexation_referendum.7.b		# calm the masses
		custom_tooltip = {
			text = annexation_referendum.7.b.tt
		}
		scope:grassroots_state_scope = {
			add_loyalists = {
				strata = poor
				value = 0.2
			}
		}
	}
}

# Stall event
#Public Address Goes Awry
annexation_referendum.8 = {
	type = country_event
	placement = scope:publicaddress_state_scope
	title = annexation_referendum.8.t
	desc = annexation_referendum.8.d
	flavor = annexation_referendum.8.f
	event_image = {
		video = "gfx/event_pictures/southamerica_election.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/election"
	icon = "gfx/interface/icons/event_icons/event_protest.dds"
	duration = 3
	cooldown = {
		months = 6
	}
	trigger = {
		has_journal_entry = annexation_referendum_je
		any_interest_group = {
			is_marginal = no
			is_in_government = yes
		}
		any_scope_state = {
			is_incorporated = yes
		}
	}
	immediate = {
		random_interest_group = {
			limit = {
				is_marginal = no
				is_in_government = yes
			}
			save_scope_as = publicaddress_ig_scope
			leader = {
				save_scope_as = publicaddress_ig_leader_scope
			}
		}
		random_scope_state = {
			limit = {
				is_incorporated = yes
			}
			save_scope_as = publicaddress_state_scope
		}
	}
	cancellation_trigger = {
		NOT = {
			has_journal_entry = annexation_referendum_je
		}
	}
	option = {
		name = annexation_referendum.8.a		# Preserve the IG
		default_option = yes
		custom_tooltip = {
			text = annexation_referendum.8.a.tt
		}
		change_variable = {
			name = weekly_annexation_support
			add = -0.5
		}
	}
	option = {
		name = annexation_referendum.8.b		# Preserve the bill
		custom_tooltip = {
			text = annexation_referendum.8.b.tt
		}
		change_variable = {
			name = weekly_annexation_support
			add = -0.25
		}
		scope:publicaddress_ig_leader_scope = {
			add_modifier = {
				name = hapless_orator
				months = 6
			}
		}
		scope:publicaddress_ig_scope = {
			add_modifier = {
				name = tainted_by_incompetence
				months = 6
			}
		}
	}
}

# Debate event
# Law proposal angers minority
annexation_referendum.9 = {
	type = country_event
	placement = scope:minority_state_scope
	title = annexation_referendum.9.t
	desc = annexation_referendum.9.d
	flavor = annexation_referendum.9.f
	event_image = {
		video = "gfx/event_pictures/europenorthamerica_political_extremism.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/europenorthamerica/political_extremism"
	icon = "gfx/interface/icons/event_icons/event_default.dds"
	duration = 3
	cooldown = {
		months = 6
	}
	trigger = {
		# law_can_hurt_minorities = yes 	# laws that in some way or form could hit minority worse than majority
		any_interest_group = {
			is_marginal = no
			is_in_government = yes
		}
		any_scope_state = {
			is_incorporated = yes
			any_scope_pop = {
				pop_is_discriminated = no
				culture = {
					NOT = { is_primary_culture_of = root.overlord }
				}
			}
		}
	}
	immediate = {
		random_interest_group = {
			limit = {
				is_marginal = no
				is_in_government = no
			}
			save_scope_as = defectors_support_ig_scope
		}
		random_scope_state = {
			limit = {
				any_scope_pop = {
					pop_is_discriminated = no
					culture = {
						NOT = { is_primary_culture_of = root.overlord }
					}
				}
			}
			random_scope_pop = {
				limit = {
					pop_is_discriminated = no
					culture = {
						NOT = { is_primary_culture_of = root.overlord }
					}
				}
				save_scope_as = minority_culture_pop_scope
			}
			save_scope_as = minority_state_scope
		}
	}
	cancellation_trigger = {
		NOT = {
			has_journal_entry = annexation_referendum_je
		}
	}
	option = {
		name = annexation_referendum.9.a		# the bill looks fine as it is, force the issue through, angering minority
		change_variable = {
			name = weekly_annexation_support
			add = 0.25
		}
		add_modifier = {
			name = minority_protests
			months = 6
		}
		scope:minority_state_scope = {
			add_radicals = {
				value = medium_radicals
				culture = scope:minority_culture_pop_scope.culture
			}
		}
	}
	option = {
		name = annexation_referendum.9.b		# token concessions
		default_option = yes
		scope:minority_state_scope = {
			add_radicals = {
				value = small_radicals
				culture = scope:minority_culture_pop_scope.culture
			}
		}
	}
	option = {
		name = annexation_referendum.9.c		# please minority
		custom_tooltip = {
			text = annexation_referendum.9.c.tt
		}
		change_variable = {
			name = weekly_annexation_support
			add = -0.25
		}
		scope:minority_state_scope = {
			add_loyalists = {
				value = medium_radicals
				culture = scope:minority_culture_pop_scope.culture
			}
		}
	}
}

annexation_referendum.100 = {
	type = country_event
	title = annexation_referendum.100.t
	desc = annexation_referendum.100.d
	flavor = annexation_referendum.100.f
	event_image = {
		video = "gfx/event_pictures/southamerica_election.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/election"
	icon = "gfx/interface/icons/event_icons/event_protest.dds"
	duration = 3
	trigger = {
		is_subject_of = overlord
	}
	cancellation_trigger = {
		NOT = { is_subject_of = overlord }
	}
	immediate = {
		save_scope_as = referendum_scope
		if = {
			limit = {
				has_variable = weekly_annexation_support
			}
			remove_variable = weekly_annexation_support
		}
		if = {
			limit = {
				has_variable = annexation_support
			}
			remove_variable = annexation_support
		}
	}
	option = { # Accept the results
		name = annexation_referendum.100.a
		every_scope_state = {
			add_modifier = {
				name = recent_referendum
				months = normal_modifier_time
				is_decaying = yes
			}
		}
		overlord = {
			annex = ROOT
		}
	}
	option = {
		name = annexation_referendum.100.b		# Ignore the results
		add_radicals = {
			value = large_radicals
		}
		overlord = {
			trigger_event = {
				id = annexation_referendum.200
				days = 0
				popup = yes
			}
		}
	}
}

annexation_referendum.101 = {
	type = country_event
	title = annexation_referendum.101.t
	desc = annexation_referendum.101.d
	flavor = annexation_referendum.101.f
	event_image = {
		video = "gfx/event_pictures/southamerica_election.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/election"
	icon = "gfx/interface/icons/event_icons/event_protest.dds"
	duration = 3
	trigger = {
		is_subject_of = overlord
	}
	cancellation_trigger = {
		NOT = { is_subject_of = overlord }
	}
	immediate = {
		save_scope_as = referendum_scope
		if = {
			limit = {
				has_variable = weekly_annexation_support
			}
			remove_variable = weekly_annexation_support
		}
		if = {
			limit = {
				has_variable = annexation_support
			}
			remove_variable = annexation_support
		}
	}
	option = { # Ignore the results
		name = annexation_referendum.101.a
		add_radicals = {
			value = very_large_radicals
		}
		every_scope_state = {
			add_modifier = {
				name = forcibly_annexed
				months = long_modifier_time
			}
		}
		overlord = {
			annex = ROOT
		}
	}
	option = {
		name = annexation_referendum.101.b		# Accept the results
		overlord = {
			trigger_event = {
				id = annexation_referendum.201
				days = 0
				popup = yes
			}
		}
	}
}

annexation_referendum.200 = {
	type = country_event
	title = annexation_referendum.200.t
	desc = annexation_referendum.200.d
	flavor = annexation_referendum.200.f
	event_image = {
		video = "gfx/event_pictures/southamerica_election.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/election"
	icon = "gfx/interface/icons/event_icons/event_protest.dds"
	duration = 3
	immediate = {
	}

	option = { # Accept the results
		name = annexation_referendum.200.a
		if = {
			limit = {
				exists = scope:referendum_scope
			}
			create_truce = {
				country = scope:referendum_scope
				months = 36
			}
		}
	}

	option = {
		name = annexation_referendum.200.b		# Ignore the results
		if = {
			limit = {
				exists = scope:referendum_scope
			}
			create_diplomatic_play = {
				target_country = scope:referendum_scope
				war = no
				type = dp_annex_subject
			}
		}
	}
}

annexation_referendum.201 = {
	type = country_event
	title = annexation_referendum.201.t
	desc = annexation_referendum.201.d
	flavor = annexation_referendum.201.f
	event_image = {
		video = "gfx/event_pictures/southamerica_election.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/election"
	icon = "gfx/interface/icons/event_icons/event_protest.dds"
	duration = 3
	immediate = {
	}

	option = { # Accept the results
		name = annexation_referendum.201.a
		if = {
			limit = {
				exists = scope:referendum_scope
			}
			create_truce = {
				country = scope:referendum_scope
				months = 36
			}
		}
	}

	option = {
		name = annexation_referendum.200.b		# Ignore the results
		if = {
			limit = {
				exists = scope:referendum_scope
			}
			change_infamy = {
				value = 25
			}
			create_diplomatic_play = {
				target_country = scope:referendum_scope
				war = no
				type = dp_annex_subject
			}
		}
	}
}

annexation_referendum.501 = {
	type = country_event
	title = annexation_referendum.501.t
	desc = annexation_referendum.501.d
	flavor = annexation_referendum.501.f
	event_image = {
		video = "gfx/event_pictures/southamerica_election.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/election"
	icon = "gfx/interface/icons/event_icons/event_protest.dds"
	duration = 3
	cooldown = {
		months = 6
	}
	trigger = {
	}
	cancellation_trigger = {
	}
	immediate = {
	}
	option = { # Fund the referendum
		name = annexation_referendum.501.a
		custom_tooltip = {
			text = annexation_referendum.501.a.tt
		}
		scope:annexation_target = {
			change_variable = {
				name = weekly_annexation_support
				add = 0.5
			}
		}
		add_modifier = {
			name = greasing_palms
			multiplier = money_amount_multiplier_medium
			months = short_modifier_time
		}
	}
	option = {
		name = annexation_referendum.501.b		# Refuse to fund the referendum
	}
}

annexation_referendum.502 = {
	type = country_event
	title = annexation_referendum.502.t
	desc = annexation_referendum.502.d
	flavor = annexation_referendum.502.f
	event_image = {
		video = "gfx/event_pictures/southamerica_election.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/election"
	icon = "gfx/interface/icons/event_icons/event_protest.dds"
	duration = 3
	cooldown = {
		months = 6
	}
	trigger = {
		any_interest_group = {
			is_marginal = no
			law_stance = {
				law = law_type:law_multicultural
				value = strongly_disapprove
			}
		}
	}
	cancellation_trigger = {
	}
	immediate = {
		random_interest_group = {
			limit = {
				is_marginal = no
				law_stance = {
					law = law_type:law_multicultural
					value = strongly_disapprove
				}
			}
			save_scope_as = opposed_ig_scope
		}
	}
	option = { # Ignore their protests
		name = annexation_referendum.502.a
		custom_tooltip = {
			text = annexation_referendum.502.a.tt
		}
		scope:annexation_target = {
			change_variable = {
				name = weekly_annexation_support
				add = 0.5
			}
		}
		scope:opposed_ig_scope = {
			add_modifier = {
				name = ig_unappeased 
				months = short_modifier_time
				is_decaying = yes
			}
		}
	}
	option = {
		name = annexation_referendum.502.b		# Acknowledge their demands
	}
}