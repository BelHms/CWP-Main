namespace = newfoundland_referendum

newfoundland_referendum.1 = { # Calling a Newfoundland National Convention
	type = country_event
	title = newfoundland_referendum.1.t
	desc = newfoundland_referendum.1.d
	flavor = newfoundland_referendum.1.f
	icon = "gfx/interface/icons/event_icons/event_diplomacy.dds"
	event_image = {
		# texture = "gfx/interface/event_pictures/.dds" TODO
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 2
	
	trigger = {
		AND = {
			game_date >= 1946.1.2
			this = c:GBR
			NOT = { has_global_variable = newfoundland_referendum_done }
		}
	}
	option = {
		name = newfoundland_referendum.1.a # Let the people of Newfoundland choose
		default_option = yes
		ai_chance = {
			base = 99
			modifier = {
				trigger = {
					OR = {
						has_global_variable = newfoundland_player
						has_global_variable = canada_player
					}
				}
				add = 1
			}				
		}
		custom_tooltip = {
			text = newfoundland_referendum_1_a_tt
		}
		hidden_effect = {
			set_global_variable = newfoundland_national_convention_start
			c:NEW = {
				trigger_event = {
					name = newfoundland_referendum.2
					days = { 180 240 }
				}
			}
		}
	}
	option = {
		name = newfoundland_referendum.1.b # Newfoundland remains a commission of the British Government
		ai_chance = {
			base = 1
			modifier = {
				trigger = {
					OR = {
						has_global_variable = newfoundland_player
						has_global_variable = canada_player
					}
				}
				add = -1
			}
		}
		custom_tooltip = {
			text = newfoundland_referendum_1_b_tt
		}
		hidden_effect = {
			s:STATE_NEWFOUNDLAND.region_state:NEW = {
				add_radicals = {
					value = medium_radicals
				}
			}
		}
	}
}

newfoundland_referendum.2 = { # Where are we sending delegates? London? Ottawa? Both?
	type = country_event
	title = newfoundland_referendum.2.t
	desc = newfoundland_referendum.2.d
	flavor = newfoundland_referendum.2.f
	icon = "gfx/interface/icons/event_icons/event_diplomacy.dds"
	event_image = {
		texture = "gfx/interface/event_pictures/national_convention_newfoundland.dds"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 2
	
	trigger = {
		AND = {
			game_date >= 1946.6.1
			this = c:NEW
		}
	}
	
	option = {
		name = newfoundland_referendum.2.a # Delegation to both London & Ottawa
		ai_chance = {
			base = 60
			modifier = {
				trigger = {
					AND = {
						has_global_variable = canada_player
						has_global_variable = uk_player
					}
				}
				add = 40
			}
			modifier = {
				trigger = {
					OR = {
						AND = {
							NOT = { has_global_variable = canada_player }
							has_global_variable = uk_player
						}
						AND = {
							NOT = { has_global_variable = uk_player }
							has_global_variable = canada_player
						}
					}
				}
				add = -60
			}
		}
		custom_tooltip = {
			text = newfoundland_referendum_2_a_tt
		}
		hidden_effect = {
			c:GBR = {
				trigger_event = {
					id = newfoundland_referendum.3	# London Delegation
					days = { 300 450 }
				}
			}
			c:CAN = {
				trigger_event = {
					id = newfoundland_referendum.4 # Ottawa Delegation
					days = { 300 450 }
				}
			}
			set_global_variable = london_and_ottawa_delegation
		}
	}
	option = {
		name = newfoundland_referendum.2.b # Delegation to London only
		ai_chance = {
			base = 20
			modifier = {
				trigger = {
					AND = {
						NOT = { has_global_variable = canada_player }
						has_global_variable = uk_player
					}
				}
				add = 80
			}
			modifier = {
				trigger = {
					has_global_variable = canada_player
				}
				add = -20
			}
		}
		custom_tooltip = {
			text = newfoundland_referendum_2_b_tt
		}
		hidden_effect = {
			c:GBR = {
				trigger_event = {
					id = newfoundland_referendum.3
					days = { 300 450 }
				}
			}
			set_global_variable = london_delegation_only
		}
	}
	option = {
		name = newfoundland_referendum.2.c # Delegation to Ottawa only
		ai_chance = {
			base = 20
			modifier = {
				trigger = {
					AND = {
						NOT = { has_global_variable = uk_player }
						has_global_variable = canada_player
					}
				}
				add = 80
			}
			modifier = {
				trigger = {
					has_global_variable = uk_player
				}
				add = -20
			}

		}
		custom_tooltip = {
			text = newfoundland_referendum_2_c_tt
		}
		hidden_effect = {
			c:CAN = {
				trigger_event = {
					id = newfoundland_referendum.4 # Ottawa Delegation
					days = { 300 450 }
				}
			}
			set_global_variable = ottawa_delegation_only
		}
	}
}
	

newfoundland_referendum.3 = { # London Delegation
	type = country_event
	title = newfoundland_referendum.3.t
	desc = newfoundland_referendum.3.d
	flavor = newfoundland_referendum.3.f
	icon = "gfx/interface/icons/event_icons/event_diplomacy.dds"
	event_image = {
		texture = "gfx/interface/event_pictures/newfoundland_london_delegation.dds"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 1
	
	trigger = {
		AND = {
			game_date >= 1947.5.1
			this = c:GBR
		}
	}
	
	option = {
		name = newfoundland_referendum.3.a # Join with Canada
		ai_chance = {
			base = 33
			modifier = {
				trigger = {
					AND = {
						NOT = { has_global_variable = newfoundland_player }
						has_global_variable = canada_player
					}
				}
				add = 67
			}
			modifier = {
				trigger = {
					has_global_variable = newfoundland_player
				}
				add = -33
			}
		}
		custom_tooltip = {
			text = newfoundland_referendum_3_a_tt
		}
		hidden_effect = {
			set_global_variable = london_delegation_finished
			set_global_variable = london_choose_confederation
			if = {
				trigger = {
					has_global_variable = ottawa_delegation_finished
					NOR = {
						has_global_variable = independence_decision_canada
						has_global_variable = independence_decision_uk
					}
				}
				c:CAN = {
					trigger_event = {
						id = newfoundland_referendum.5 # Newfoundland Independence option
						days = { 180 300 }
					}
				}
				c:GBR = {
					trigger_event = {
						id = newfoundland_referendum.5 # Newfoundland Independence option
						days = { 180 300 }
					}
				}
			}
		}
	}
	option = {
		name = newfoundland_referendum.3.b # We have no preference
		ai_chance = {
			base = 34
			modifier = {
				trigger = {
					has_global_variable = newfoundland_player
				}
				add = 66
			}
			modifier = {
				trigger = {
					AND = {
						NOT = { has_global_variable = newfoundland_player }
						has_global_variable = canada_player
					}
				}
				add = -34
			}
		}
		custom_tooltip = {
			text = newfoundland_referendum_3_b_tt
		}
		hidden_effect = {
			set_global_variable = london_delegation_finished
			set_global_variable = london_no_preference
			if = {
				trigger = {
					has_global_variable = ottawa_delegation_finished
					NOR = {
						has_global_variable = independence_decision_canada
						has_global_variable = independence_decision_uk
					}
				}
				c:CAN = {
					trigger_event = {
						id = newfoundland_referendum.5 # Newfoundland Independence option
						days = { 180 300 }
					}
				}
				c:GBR = {
					trigger_event = {
						id = newfoundland_referendum.5 # Newfoundland Independence option
						days = { 180 300 }
					}
				}
			}
		}
	}
	option = {
		name = newfoundland_referendum.3.c # Become a Dominion
		ai_chance = {
			base = 33
			modifier = {
				trigger = {
					OR = {
						has_global_variable = newfoundland_player
						has_global_variable = canada_player
					}
				}
				add = -33
			}
		}
		custom_tooltip = {
			text = newfoundland_referendum_3_c_tt
		}
		hidden_effect = {
			set_global_variable = london_delegation_finished
			set_global_variable = london_choose_dominion
			if = {
				trigger = {
					has_global_variable = ottawa_delegation_finished
					NOR = {
						has_global_variable = independence_decision_canada
						has_global_variable = independence_decision_uk
					}
				}
				c:CAN = {
					trigger_event = {
						id = newfoundland_referendum.5 # Newfoundland Independence option
						days = { 180 300 }
					}
				}
				c:GBR = {
					trigger_event = {
						id = newfoundland_referendum.5 # Newfoundland Independence option
						days = { 180 300 }
					}
				}
			}
		}
	}
}

newfoundland_referendum.4 = { # Ottawa Delegation
	type = country_event
	title = newfoundland_referendum.4.t
	desc = newfoundland_referendum.4.d
	flavor = newfoundland_referendum.4.f
	icon = "gfx/interface/icons/event_icons/event_diplomacy.dds"
	event_image = {
		texture = "gfx/interface/event_pictures/newfoundland_ottawa_delegation.dds"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 1
	
	trigger = {
		AND = {
			game_date >= 1947.5.1
			this = c:CAN
		}
	}
	
	option = {
		name = newfoundland_referendum.4.a # Join with Canada
		ai_chance = {
			base = 60
			modifier = {
				trigger = {
					has_global_variable = newfoundland_player
				}
				add = -60
			}
		}
		custom_tooltip = {
			text = newfoundland_referendum_4_a_tt
		}
		hidden_effect = {
			set_global_variable = ottawa_delegation_finished
			set_global_variable = ottawa_choose_confederation
			if = {
				trigger = {
					has_global_variable = london_delegation_finished
					NOR = {
						has_global_variable = independence_decision_canada
						has_global_variable = independence_decision_uk
					}
				}
				c:CAN = {
					trigger_event = {
						id = newfoundland_referendum.5 # Newfoundland Independence option
						days = { 180 300 }
					}
				}
				c:GBR = {
					trigger_event = {
						id = newfoundland_referendum.5 # Newfoundland Independence option
						days = { 180 300 }
					}
				}
			}
		}
	}
	option = {
		name = newfoundland_referendum.4.b # We have no preference
		ai_chance = {
			base = 30
			modifier = {
				trigger = {
					has_global_variable = newfoundland_player
				}
				add = 70
			}
		}
		custom_tooltip = {
			text = newfoundland_referendum_4_b_tt
		}
		hidden_effect = {
			set_global_variable = ottawa_delegation_finished
			set_global_variable = ottawa_no_preference
			if = {
				trigger = {
					has_global_variable = london_delegation_finished
					NOR = {
						has_global_variable = independence_decision_canada
						has_global_variable = independence_decision_uk
					}
				}
				c:CAN = {
					trigger_event = {
						id = newfoundland_referendum.5 # Newfoundland Independence option
						days = { 180 300 }
					}
				}
				c:GBR = {
					trigger_event = {
						id = newfoundland_referendum.5 # Newfoundland Independence option
						days = { 180 300 }
					}
				}
			}
		}
	}
	option = {
		name = newfoundland_referendum.4.c # Remain a Dominion
		ai_chance = {
			base = 10
			modifier = {
				trigger = {
					has_global_variable = newfoundland_player
				}
				add = -10
			}
		}
		custom_tooltip = {
			text = newfoundland_referendum_4_c_tt
		}
		hidden_effect = {
			set_global_variable = ottawa_delegation_finished
			set_global_variable = ottawa_choose_dominion
			if = {
				trigger = {
					has_global_variable = london_delegation_finished
					NOR = {
						has_global_variable = independence_decision_canada
						has_global_variable = independence_decision_uk
					}
				}
				c:CAN = {
					trigger_event = {
						id = newfoundland_referendum.5 # Newfoundland Independence option
						days = { 180 300 }
					}
				}
				c:GBR = {
					trigger_event = {
						id = newfoundland_referendum.5 # Newfoundland Independence option
						days = { 180 300 }
					}
				}
			}
		}
	}
}

newfoundland_referendum.5 = { # Should independence be an option for Newfoundland?
	type = country_event
	title = newfoundland_referendum.5.t
	desc = newfoundland_referendum.5.d
	flavor = newfoundland_referendum.5.f
	icon = "gfx/interface/icons/event_icons/event_diplomacy.dds"
	event_image = {
		# texture = "gfx/interface/event_pictures/.dds" TODO
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 1
	
	trigger = {
		OR = {
			this = c:GBR
			this = c:CAN
		}
		AND = {
			has_global_variable = london_delegation_finished
			has_global_variable = ottawa_delegation_finished
		}
		game_date >= 1948.1.1
	}
	
	immediate = {
		if = {
			limit = {
				this = c:CAN
			}
			set_global_variable = independence_decision_canada
		}
		if = {
			limit = {
				this = c:GBR
			}
			set_global_variable = independence_decision_uk
		}
	}
		
	option = {
		name = newfoundland_referendum.5.a # Independence shouldn't be an option
		ai_chance = {
			base = 50
			modifier = {
				trigger = {
					AND = {
						OR = {
							has_global_variable = ottawa_choose_dominion
							has_global_variable = ottawa_choose_confederation
						}
						OR = {
							has_global_variable = london_choose_dominion
							has_global_variable = london_choose_confederation
						}
						NOT = { has_global_variable = newfoundland_player }
					}
				}
				add = 50
			}
			modifier = {
				trigger = {
					OR = {
						AND = {
							OR = {
								has_global_variable = ottawa_choose_dominion
								has_global_variable = ottawa_choose_confederation
							}
							has_global_variable = london_no_preference
							NOT = { has_global_variable = newfoundland_player }
						}
						AND = {
							OR = {
								has_global_variable = london_choose_dominion
								has_global_variable = london_choose_confederation
							}
							has_global_variable = ottawa_no_preference
							NOT = { has_global_variable = newfoundland_player }
						}
					}
				}
				add = 25 # Either the UK or Canada have argued that Newfoundland shouldn't be independent, but the other doesn't care
			}
			modifier = {
				trigger = {
					has_global_variable = newfoundland_player
				}
				add = -50
			}
		}
		custom_tooltip = {
			text = newfoundland_referendum_5_a_tt
		}
		hidden_effect = {
			if = {
				limit = {
					this = c:GBR
					NOT = { this = c:CAN }
				}
				set_global_variable = london_no_newfoundland_independence
			}
			if = {
				limit = {
					this = c:CAN
					NOT = { this = c:GBR }
				}
				set_global_variable = ottawa_no_newfoundland_independence
			}
		}
	}
	option = {
		name = newfoundland_referendum.5.b # Independence should be an option
		ai_chance = {
			base = 50
			modifier = {
				trigger = {
					AND = {
						OR = {
							has_global_variable = ottawa_choose_dominion
							has_global_variable = ottawa_choose_confederation
						}
						OR = {
							has_global_variable = london_choose_dominion
							has_global_variable = london_choose_confederation
						}
						NOT = { has_global_variable = newfoundland_player }
					}
				}
				add = -50
			}
			modifier = {
				trigger = {
					OR = {
						AND = {
							OR = {
								has_global_variable = ottawa_choose_dominion
								has_global_variable = ottawa_choose_confederation
							}
							has_global_variable = london_no_preference
							NOT = { has_global_variable = newfoundland_player }
						}
						AND = {
							OR = {
								has_global_variable = london_choose_dominion
								has_global_variable = london_choose_confederation
							}
							has_global_variable = ottawa_no_preference
							NOT = { has_global_variable = newfoundland_player }
						}
					}
				}
				add = -25
			}
			modifier = {
				trigger = {
					has_global_variable = newfoundland_player
				}
				add = 50
			}
		}
		custom_tooltip = {
			text = newfoundland_referendum_5_b_tt
		}
		hidden_effect = {
			if = {
				limit = {
					this = c:GBR
					NOT = { this = c:CAN }
				}
				set_global_variable = london_yes_newfoundland_independence
			}
			if = {
				limit = {
					this = c:CAN
					NOT = { this = c:GBR }
				}
				set_global_variable = ottawa_yes_newfoundland_independence
			}
		}
	}
}

newfoundland_referendum.6 = { # First Referendum - Independence possible
	type = country_event
	title = newfoundland_referendum.6.t
	desc = newfoundland_referendum.6.d
	flavor = newfoundland_referendum.6.f
	icon = "gfx/interface/icons/event_icons/event_diplomacy.dds"
	event_image = {
		# texture = "gfx/interface/event_pictures/.dds" TODO
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 1
	
	trigger = {
		game_date >= 1948.6.1
		NOT = { has_global_variable = newfoundland_first_referendum_started }
		this = c:NEW
	}
	
	immediate = {
		set_global_variable = newfoundland_first_referendum_started
	}
	
	option = {
		name = newfoundland_referendum.6.a # Become a British Dominion
		ai_chance = {
			base = 40
		}
		custom_tooltip = {
			text = newfoundland_referendum_6_a_tt
		}
		hidden_effect = {
			set_global_variable = newfoundland_first_referendum_failed
			c:NEW = {
				trigger_event = {
					id = newfoundland_referendum.8 # Second Referendum - Dominion or Confederate
					days = 45
				}
			}
		}
	}
	option = {
		name = newfoundland_referendum.6.b # Confederate with Canada
		ai_chance = {
			base = 35
		}
		custom_tooltip = {
			text = newfoundland_referendum_6_b_tt
		}
		hidden_effect = {
			set_global_variable = newfoundland_first_referendum_failed
			c:NEW = {
				trigger_event = {
					id = newfoundland_referendum.8 # Second Referendum - Dominion or Confederate
					days = 45
				}
			}
		}
	}
	option = {
		name = newfoundland_referendum.6.c # Remain a dependent territory
		ai_chance = {
			base = 15
		}
		custom_tooltip = {
			text = newfoundland_referendum_6_c_tt
		}
		hidden_effect = {
			set_global_variable = newfoundland_dependent_territory
			c:NEW = {
				trigger_event = {
					id = newfoundland_referendum.11 # First Referendum - Independence possible
					days = 45
				}
			}
		}
	}
	option = {
		name = newfoundland_referendum.6.d # Independence
		ai_chance = {
			base = 10
		}
		custom_tooltip = {
			text = newfoundland_referendum_6_d_tt
		}
		hidden_effect = {
			set_global_variable = newfoundland_independent
			c:NEW = {
				trigger_event = {
					id = newfoundland_referendum.12 # First Referendum - Independence possible
					days = 45
				}
			}
		}
	}
}

newfoundland_referendum.7 = { # First Referendum - Independence not possible
	type = country_event
	title = newfoundland_referendum.7.t
	desc = newfoundland_referendum.7.d
	flavor = newfoundland_referendum.7.f
	icon = "gfx/interface/icons/event_icons/event_diplomacy.dds"
	event_image = {
		# texture = "gfx/interface/event_pictures/.dds" TODO
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 1
	
	trigger = {
		game_date >= 1948.6.1
		NOT = { has_global_variable = newfoundland_first_referendum_started }
		this = c:NEW
	}
	
	immediate = {
		set_global_variable = newfoundland_first_referendum_started
	}
	
	option = {
		name = newfoundland_referendum.7.a # Become a British Dominion
		ai_chance = {
			base = 44
		}
		custom_tooltip = {
			text = newfoundland_referendum_7_a_tt
		}
		hidden_effect = {
			set_global_variable = newfoundland_first_referendum_failed
			c:NEW = {
				trigger_event = {
					id = newfoundland_referendum.8 # Second Referendum - Dominion or Confederate
					days = 45
				}
			}
		}
	}
	option = {
		name = newfoundland_referendum.7.b # Confederate with Canada
		ai_chance = {
			base = 41
		}
		custom_tooltip = {
			text = newfoundland_referendum_7_b_tt
		}
		hidden_effect = {
			set_global_variable = newfoundland_first_referendum_failed
			c:NEW = {
				trigger_event = {
					id = newfoundland_referendum.8 # Second Referendum - Dominion or Confederate
					days = 45
				}
			}
		}
	}
	option = {
		name = newfoundland_referendum.7.c # Remain a dependent territory
		ai_chance = {
			base = 15
		}
		custom_tooltip = {
			text = newfoundland_referendum_7_c_tt
		}
		hidden_effect = {
			set_global_variable = newfoundland_dependent_territory
			c:NEW = {
				trigger_event = {
					id = newfoundland_referendum.11 # Remain a British Dependent Territory
					days = 45
				}
			}
		}
	}
}

newfoundland_referendum.8 = { # Second Referendum - Confederate with Canada or British Dominion
	type = country_event
	title = newfoundland_referendum.8.t
	desc = newfoundland_referendum.8.d
	flavor = newfoundland_referendum.8.f
	icon = "gfx/interface/icons/event_icons/event_diplomacy.dds"
	event_image = {
		# texture = "gfx/interface/event_pictures/.dds" TODO
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 1
	
	trigger = {
		game_date >= 1948.7.1
		has_global_variable = newfoundland_first_referendum_failed
		NOR = { 
			has_global_variable = newfoundland_dependent_territory
			has_global_variable = newfoundland_independent
		}
		this = c:NEW
	}
	
	immediate = {
		set_global_variable = newfoundland_second_referendum_started
	}
	
	option = {
		name = newfoundland_referendum.8.a # Become a British Dominion
		ai_chance = {
			base = 48
		}
		custom_tooltip = {
			text = newfoundland_referendum_8_a_tt
		}
		hidden_effect = {
			set_global_variable = newfoundland_dominion
			c:NEW = {
				trigger_event = {
					id = newfoundland_referendum.9 # Remain a British Dependent Territory
					days = 45
				}
			}
		}
	}
	option = {
		name = newfoundland_referendum.8.b # Confederate with Canada
		ai_chance = {
			base = 52
		}
		custom_tooltip = {
			text = newfoundland_referendum_8_b_tt
		}
		hidden_effect = {
			set_global_variable = newfoundland_confederate
			c:NEW = {
				trigger_event = {
					id = newfoundland_referendum.10 # Remain a British Dependent Territory
					days = 45
				}
			}
		}
	}
}

newfoundland_referendum.9 = { # British Dominion - Newfoundland POV
	type = country_event
	title = newfoundland_referendum.9.t
	desc = newfoundland_referendum.9.d
	flavor = newfoundland_referendum.9.f
	icon = "gfx/interface/icons/event_icons/event_diplomacy.dds"
	event_image = {
		# texture = "gfx/interface/event_pictures/.dds" TODO
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 1
	
	trigger = {
		game_date >= 1948.8.1
		has_global_variable = newfoundland_dominion
		NOR = { 
			has_global_variable = newfoundland_independent
			has_global_variable = newfoundland_confederate
			has_global_variable = newfoundland_dependent_territory
		}
		this = c:NEW
	}
	
	option = {
		name = newfoundland_referendum.9.a
		default_option = yes
		ai_chance = {
			base = 100
		}
		custom_tooltip = {
			text = newfoundland_referendum_9_a_tt
		}
		change_subject_type = dominion
		hidden_effect = {
			set_global_variable = newfoundland_referendum_done
			trigger_event = {
				id = newfoundland_referendum.997 # Cleaning up global variables
				days = 120
			}
		}
	}
}

newfoundland_referendum.10 = { # Confederate with Canada - Canada POV
	type = country_event
	title = newfoundland_referendum.10.t
	desc = newfoundland_referendum.10.d
	flavor = newfoundland_referendum.10.f
	icon = "gfx/interface/icons/event_icons/event_diplomacy.dds"
	event_image = {
		# texture = "gfx/interface/event_pictures/.dds" TODO
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 3
	
	trigger = {
		game_date >= 1948.8.1
		has_global_variable = newfoundland_first_referendum_failed
		NOR = { 
			has_global_variable = newfoundland_independent
			has_global_variable = newfoundland_dominion
			has_global_variable = newfoundland_dependent_territory
		}
		this = c:NEW
	}
	
	option = {
		name = newfoundland_referendum.10.a
		default_option = yes
		ai_chance = {
			base = 100
		}
		custom_tooltip = {
			text = newfoundland_referendum_10_a_tt
		}
		c:CAN = {
			annex = c:NEW
			s:STATE_NEWFOUNDLAND.region_state:CAN = {
				state_type = incorporated
			}
		}
		hidden_effect = {
			set_global_variable = newfoundland_referendum_done
			trigger_event = {
				id = newfoundland_referendum.997 # Cleaning up global variables
				days = 120
			}
		}
	}
}

newfoundland_referendum.11 = { # Dependent Territory
	type = country_event
	title = newfoundland_referendum.11.t
	desc = newfoundland_referendum.11.d
	flavor = newfoundland_referendum.11.f
	icon = "gfx/interface/icons/event_icons/event_diplomacy.dds"
	event_image = {
		# texture = "gfx/interface/event_pictures/.dds" TODO
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 3
	
	trigger = {
		game_date >= 1948.7.1
		has_global_variable = newfoundland_dependent_territory
		NOR = { 
			has_global_variable = newfoundland_independent
			has_global_variable = newfoundland_confederate
			has_global_variable = newfoundland_dominion
		}
		this = c:NEW
	}
	
	option = {
		name = newfoundland_referendum.11.a
		default_option = yes
		ai_chance = {
			base = 100
		}
		custom_tooltip = {
			text = newfoundland_referendum_11_a_tt
		}
		hidden_effect = {
			set_global_variable = newfoundland_referendum_done
			trigger_event = {
				id = newfoundland_referendum.997 # Cleaning up global variables
				days = 120
			}
		}
	}
}

newfoundland_referendum.12 = { # Independence
	type = country_event
	title = newfoundland_referendum.12.t
	desc = newfoundland_referendum.12.d
	flavor = newfoundland_referendum.12.f
	icon = "gfx/interface/icons/event_icons/event_diplomacy.dds"
	event_image = {
		# texture = "gfx/interface/event_pictures/.dds" TODO
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 3
	
	trigger = {
		game_date >= 1948.7.1
		AND = {
			has_global_variable = newfoundland_independent
			NOR = { 
				has_global_variable = newfoundland_dominion
				has_global_variable = newfoundland_confederate
				has_global_variable = newfoundland_dependent_territory
			}
		}
		this = c:NEW
	}
	
	option = {
		name = newfoundland_referendum.12.a
		default_option = yes
		ai_chance = {
			base = 100
		}
		custom_tooltip = {
			text = newfoundland_referendum_12_a_tt
		}
		remove_diplomatic_pact = {
			country = c:GBR
			type = dependent_territory
		}
		hidden_effect = {
			set_global_variable = newfoundland_referendum_done
			trigger_event = {
				id = newfoundland_referendum.997 # Cleaning up global variables
				days = 120
			}
		}
	}
}

newfoundland_referendum.13 = { # British Dominion - Canadian POV
	type = country_event
	title = newfoundland_referendum.13.t
	desc = newfoundland_referendum.13.d
	flavor = newfoundland_referendum.13.f
	icon = "gfx/interface/icons/event_icons/event_diplomacy.dds"
	event_image = {
		# texture = "gfx/interface/event_pictures/.dds" TODO
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 3
	
	trigger = {
		this = c:CAN
		NOR = {
			this = c:NEW
			this = c:GBR
		}
		has_global_variable = newfoundland_dominion
		NOR = {
			has_global_variable = newfoundland_confederate
			has_global_variable = newfoundland_independent
			has_global_variable = newfoundland_dependent_territory
		}
	}
	
	option = {
		name = newfoundland_referendum.13.a
		default_option = yes
		ai_chance = {
			base = 100
		}
		custom_tooltip = {
			text = newfoundland_referendum_13_a_tt
		}
	}
}
	
newfoundland_referendum.14 = { # British Dominion - British POV
	type = country_event
	title = newfoundland_referendum.14.t
	desc = newfoundland_referendum.14.d
	flavor = newfoundland_referendum.14.f
	icon = "gfx/interface/icons/event_icons/event_diplomacy.dds"
	event_image = {
		# texture = "gfx/interface/event_pictures/.dds" TODO
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 3
	
	trigger = {
		this = c:GBR
		NOR = {
			this = c:NEW
			this = c:CAN
		}
		has_global_variable = newfoundland_dominion
		NOR = {
			has_global_variable = newfoundland_confederate
			has_global_variable = newfoundland_independent
			has_global_variable = newfoundland_dependent_territory
		}
	}
	
	option = {
		name = newfoundland_referendum.14.a
		default_option = yes
		ai_chance = {
			base = 100
		}
		custom_tooltip = {
			text = newfoundland_referendum_14_a_tt
		}
	}
}
	
newfoundland_referendum.15 = { # Confederate with Canada - British POV
	type = country_event
	title = newfoundland_referendum.15.t
	desc = newfoundland_referendum.15.d
	flavor = newfoundland_referendum.15.f
	icon = "gfx/interface/icons/event_icons/event_diplomacy.dds"
	event_image = {
		# texture = "gfx/interface/event_pictures/.dds" TODO
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 3
	
	trigger = {
		this = c:GBR
		NOR = {
			this = c:NEW
			this = c:CAN
		}
		has_global_variable = newfoundland_confederate
		NOR = {
			has_global_variable = newfoundland_dominion
			has_global_variable = newfoundland_independent
			has_global_variable = newfoundland_dependent_territory
		}
	}
	
	option = {
		name = newfoundland_referendum.15.a
		default_option = yes
		ai_chance = {
			base = 100
		}
		custom_tooltip = {
			text = newfoundland_referendum_15_a_tt
		}
	}
}
	
newfoundland_referendum.16 = { # Confederate with Canada - Canadian POV
	type = country_event
	title = newfoundland_referendum.16.t
	desc = newfoundland_referendum.16.d
	flavor = newfoundland_referendum.16.f
	icon = "gfx/interface/icons/event_icons/event_diplomacy.dds"
	event_image = {
		# texture = "gfx/interface/event_pictures/.dds" TODO
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 3
	
	trigger = {
		this = c:CAN
		NOR = {
			this = c:NEW
			this = c:GBR
		}
		has_global_variable = newfoundland_confederate
		NOR = {
			has_global_variable = newfoundland_dominion
			has_global_variable = newfoundland_independent
			has_global_variable = newfoundland_dependent_territory
		}
	}
	
	option = {
		name = newfoundland_referendum.16.a
		default_option = yes
		ai_chance = {
			base = 100
		}
		custom_tooltip = {
			text = newfoundland_referendum_16_a_tt
		}
	}
}
	
newfoundland_referendum.17 = { # Remain a British Dependent Territory - British POV
	type = country_event
	title = newfoundland_referendum.17.t
	desc = newfoundland_referendum.17.d
	flavor = newfoundland_referendum.17.f
	icon = "gfx/interface/icons/event_icons/event_diplomacy.dds"
	event_image = {
		# texture = "gfx/interface/event_pictures/.dds" TODO
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 3
	
	trigger = {
		this = c:GBR
		NOR = {
			this = c:NEW
			this = c:CAN
		}
		has_global_variable = newfoundland_dependent_territory
		NOR = {
			has_global_variable = newfoundland_dominion
			has_global_variable = newfoundland_independent
			has_global_variable = newfoundland_confederate
		}
	}
	
	option = {
		name = newfoundland_referendum.17.a
		default_option = yes
		ai_chance = {
			base = 100
		}
		custom_tooltip = {
			text = newfoundland_referendum_17_a_tt
		}
	}
}
	
newfoundland_referendum.18 = { # Remain a British Dependent Territory - Canadian POV
	type = country_event
	title = newfoundland_referendum.18.t
	desc = newfoundland_referendum.18.d
	flavor = newfoundland_referendum.18.f
	icon = "gfx/interface/icons/event_icons/event_diplomacy.dds"
	event_image = {
		# texture = "gfx/interface/event_pictures/.dds" TODO
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 3
	
	trigger = {
		this = c:CAN
		NOR = {
			this = c:NEW
			this = c:GBR
		}
		has_global_variable = newfoundland_dependent_territory
		NOR = {
			has_global_variable = newfoundland_dominion
			has_global_variable = newfoundland_independent
			has_global_variable = newfoundland_confederate
		}
	}
	
	option = {
		name = newfoundland_referendum.18.a
		default_option = yes
		ai_chance = {
			base = 100
		}
		custom_tooltip = {
			text = newfoundland_referendum_18_a_tt
		}
	}
}
	
newfoundland_referendum.19 = { # Newfoundland Independence - British POV
	type = country_event
	title = newfoundland_referendum.19.t
	desc = newfoundland_referendum.19.d
	flavor = newfoundland_referendum.19.f
	icon = "gfx/interface/icons/event_icons/event_diplomacy.dds"
	event_image = {
		# texture = "gfx/interface/event_pictures/.dds" TODO
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 3
	
	trigger = {
		this = c:GBR
		NOR = {
			this = c:NEW
			this = c:CAN
		}
		has_global_variable = newfoundland_independent
		NOR = {
			has_global_variable = newfoundland_dominion
			has_global_variable = newfoundland_dependent_territory
			has_global_variable = newfoundland_confederate
		}
	}
	
	option = {
		name = newfoundland_referendum.19.a
		default_option = yes
		ai_chance = {
			base = 100
		}
		custom_tooltip = {
			text = newfoundland_referendum_19_a_tt
		}
	}
}
	
newfoundland_referendum.20 = { # Newfoundland Independence - Canadian POV
	type = country_event
	title = newfoundland_referendum.20.t
	desc = newfoundland_referendum.20.d
	flavor = newfoundland_referendum.20.f
	icon = "gfx/interface/icons/event_icons/event_diplomacy.dds"
	event_image = {
		# texture = "gfx/interface/event_pictures/.dds" TODO
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 3
	
	trigger = {
		this = c:CAN
		NOR = {
			this = c:NEW
			this = c:GBR
		}
		has_global_variable = newfoundland_independent
		NOR = {
			has_global_variable = newfoundland_dominion
			has_global_variable = newfoundland_dependent_territory
			has_global_variable = newfoundland_confederate
		}
	}
	
	option = {
		name = newfoundland_referendum.20.a
		default_option = yes
		ai_chance = {
			base = 100
		}
		custom_tooltip = {
			text = newfoundland_referendum_20_a_tt
		}
	}
}

newfoundland_referendum.21 = { # Does the USA send a join market offer to an independent Newfoundland?
	type = country_event
	title = newfoundland_referendum.21.t
	desc = newfoundland_referendum.21.d
	flavor = newfoundland_referendum.21.f
	icon = "gfx/interface/icons/event_icons/event_diplomacy.dds"
	event_image = {
		# texture = "gfx/interface/event_pictures/.dds" TODO
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 3
	
	trigger = {
		this = c:USA
		has_global_variable = newfoundland_referendum_done
		c:NEW = {
			is_subject = no
		}
	}
	
	option = {
		name = newfoundland_referendum.21.a
		default_option = yes
		ai_chance = {
			base = 75
		}
		custom_tooltip = {
			text = newfoundland_referendum_21_a_tt
		}
		c:NEW = {
			trigger_event = {
				id = newfoundland_referendum.22 # Choice for Newfoundland to join the US's market
				days = 120
			}
		}
	}
	option = {
		name = newfoundland_referendum.21.b
		default_option = yes
		ai_chance = {
			base = 25
		}
		custom_tooltip = {
			text = newfoundland_referendum_21_b_tt
		}
	}
}

newfoundland_referendum.22 = { # Does Newfoundland join the USA's market?
	type = country_event
	title = newfoundland_referendum.22.t
	desc = newfoundland_referendum.22.d
	flavor = newfoundland_referendum.22.f
	icon = "gfx/interface/icons/event_icons/event_diplomacy.dds"
	event_image = {
		# texture = "gfx/interface/event_pictures/.dds" TODO
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	
	duration = 3
	
	trigger = {
		this = c:NEW
		has_global_variable = newfoundland_referendum_done
		is_subject = no
	}
	
	option = {
		name = newfoundland_referendum.22.a
		default_option = yes
		ai_chance = {
			base = 75
		}
		custom_tooltip = {
			text = newfoundland_referendum_22_a_tt
		}
		c:USA = {
			create_diplomatic_pact = {
				tcountry = c:NEW
				type = customs_union
			}
		}
	}
	option = {
		name = newfoundland_referendum.22.b
		default_option = yes
		ai_chance = {
			base = 25
		}
		custom_tooltip = {
			text = newfoundland_referendum_22_b_tt
		}
	}
}

newfoundland_referendum.997 = { # Cleaning up
	type = country_event
	hidden = yes
	trigger = {
		has_global_variable = newfoundland_referendum_done
	}
	
	immediate = {
		if = {
			limit = {
				has_global_variable = uk_player
			}
			remove_global_variable = uk_player
		}
		if = {
			limit = {
				has_global_variable = newfoundland_player
			}
			remove_global_variable = newfoundland_player
		}
		if = {
			limit = {
				has_global_variable = canada_player
			}
			remove_global_variable = canada_player
		}
		if = {
			limit = {
				has_global_variable = newfoundland_national_convention_start
			}
			remove_global_variable = newfoundland_national_convention_start
		}
		if = {
			limit = {
				has_global_variable = london_and_ottawa_delegation
			}
			remove_global_variable = london_and_ottawa_delegation
		}
		if = {
			limit = {
				has_global_variable = london_delegation_only
			}
			remove_global_variable = london_delegation_only
		}
		if = {
			limit = {
				has_global_variable = ottawa_delegation_only
			}
			remove_global_variable = ottawa_delegation_only
		}
		if = {
			limit = {
				has_global_variable = london_delegation_finished
			}
			remove_global_variable = london_delegation_finished
		}
		if = {
			limit = {
				has_global_variable = london_choose_confederation
			}
			remove_global_variable = london_choose_confederation
		}
		if = {
			limit = {
				has_global_variable = london_no_preference
			}
			remove_global_variable = london_no_preference
		}
		if = {
			limit = {
				has_global_variable = london_choose_dominion
			}
			remove_global_variable = london_choose_dominion
		}
		if = {
			limit = {
				has_global_variable = ottawa_delegation_finished
			}
			remove_global_variable = ottawa_delegation_finished
		}
		if = {
			limit = {
				has_global_variable = ottawa_choose_confederation
			}
			remove_global_variable = ottawa_choose_confederation
		}
		if = {
			limit = {
				has_global_variable = ottawa_no_preference
			}
			remove_global_variable = ottawa_no_preference
		}
		if = {
			limit = {
				has_global_variable = ottawa_choose_dominion
			}
			remove_global_variable = ottawa_choose_dominion
		}
		if = {
			limit = {
				has_global_variable = independence_decision_canada
			}
			remove_global_variable = independence_decision_canada
		}
		if = {
			limit = {
				has_global_variable = independence_decision_uk
			}
			remove_global_variable = independence_decision_uk
		}
		if = {
			limit = {
				has_global_variable = london_no_newfoundland_independence
			}
			remove_global_variable = london_no_newfoundland_independence
		}
		if = {
			limit = {
				has_global_variable = london_yes_newfoundland_independence
			}
			remove_global_variable = london_yes_newfoundland_independence
		}
		if = {
			limit = {
				has_global_variable = ottawa_no_newfoundland_independence
			}
			remove_global_variable = ottawa_no_newfoundland_independence
		}
		if = {
			limit = {
				has_global_variable = ottawa_yes_newfoundland_independence
			}
			remove_global_variable = ottawa_yes_newfoundland_independence
		}
		if = {
			limit = {
				has_global_variable = newfoundland_first_referendum_started
			}
			remove_global_variable = newfoundland_first_referendum_started
		}
		if = {
			limit = {
				has_global_variable = newfoundland_first_referendum_failed
			}
			remove_global_variable = newfoundland_first_referendum_failed
		}
		if = {
			limit = {
				has_global_variable = newfoundland_dependent_territory
			}
			remove_global_variable = newfoundland_dependent_territory
		}
		if = {
			limit = {
				has_global_variable = newfoundland_independent
			}
			remove_global_variable = newfoundland_independent
		}
		if = {
			limit = {
				has_global_variable = newfoundland_second_referendum_started
			}
			remove_global_variable = newfoundland_second_referendum_started
		}
		if = {
			limit = {
				has_global_variable = newfoundland_dominion
			}
			remove_global_variable = newfoundland_dominion
		}
		if = {
			limit = {
				has_global_variable = newfoundland_confederate
			}
			remove_global_variable = newfoundland_confederate
		}
	}
}

newfoundland_referendum.998 = { # Determining whether the first referendum will have an independence option
	type = country_event
	hidden = yes
	trigger = {
		OR = {
			has_global_variable = london_no_newfoundland_independence
			has_global_variable = london_yes_newfoundland_independence
		}
		OR = {
			has_global_variable = ottawa_no_newfoundland_independence
			has_global_variable = ottawa_yes_newfoundland_independence
		}
		NOR = {
			has_global_variable = newfoundland_confederate
			has_global_variable = newfoundland_dominion
			has_global_variable = newfoundland_dependent_territory
			has_global_variable = newfoundland_independent
		}
	}
	immediate = {
		if = {
			limit = {
				AND = {
					has_global_variable = ottawa_no_newfoundland_independence
					has_global_variable = london_no_newfoundland_independence
					NOT = { has_global_variable = newfoundland_player }
				}
			}
			c:NEW = {
				trigger_event = {
					id = newfoundland_referendum.7 # First Referendum - Independence not possible
					days = { 90 180 }
				}
			}
		}
		if = {
			limit = {
				OR = {
					AND = {
						has_global_variable = ottawa_no_newfoundland_independence
						has_global_variable = london_yes_newfoundland_independence
					}
					AND = {
						has_global_variable = ottawa_yes_newfoundland_independence
						has_global_variable = london_no_newfoundland_independence
					}
				}
			}
			random_list = {
				50 = {
					c:NEW = {
						trigger_event = {
							id = newfoundland_referendum.7 # First Referendum - Independence not possible
							days = { 90 180 }
						}
					}
				}
				50 = {
					c:NEW = {
						trigger_event = {
							id = newfoundland_referendum.6 # First Referendum - Independence possible
							days = { 90 180 }
						}
					}
				}
			}
		}
		if = {
			limit = {
				OR = {
					AND = {
						has_global_variable = ottawa_yes_newfoundland_independence
						has_global_variable = london_yes_newfoundland_independence
					}
					has_global_variable = newfoundland_player
				}
			}
			c:NEW = {
				trigger_event = {
					id = newfoundland_referendum.6 # First Referendum - Independence possible
					days = { 90 180 }
				}
			}
		}
	}
}

newfoundland_referendum.999 = { # Sets up who the players are
	type = country_event
	hidden = yes
	immediate = {
		if = {
			limit = {
				AND = {
					exists = c:NEW
					c:NEW = {
						is_player = yes
					}
				}
			}
			set_global_variable = newfoundland_player
		}
		if = {
			limit = {
				AND = {
					exists = c:CAN
					c:CAN = {
						is_player = yes
					}
				}
			}
			set_global_variable = canada_player
		}
		if = {
			limit = {
				AND = {
					exists = c:GBR
					c:GBR = {
						is_player = yes
					}
				}
			}
			set_global_variable = uk_player
		}
	}
}